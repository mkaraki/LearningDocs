---
lang: ja
---
# Windowsコマンド 基礎

## 対象者
- [Windows/DOSコマンド 基礎](dos-command01.md)を理解している

## 環境
- Windows 10以降のWindows

## 環境構築

**警告:** [Windows/DOSコマンド 基礎](dos-command01.md)と違い、ローカルのコンピュータ上で作業を行うため、
間違ったコマンドを実行するとデータの喪失につながる。

1. `Windows`キーを押しながら`R`キーを押し、`名前を指定して実行`を起動する
1. `cmd`と入力し、`Enter`を押す
1. (初回の場合) `mkdir class-wincmd01`を実行する
1. (2回目以降の場合) `cd class-wincmd01`を実行する

## この資料の書式について
この資料では、コマンドの前に`> `を付ける。
これは、コンソールに打ち込んだ値と、予測される実行結果を明示的に区別できるようにするためである。

コマンドをすべて大文字で記述している。
これは各自小文字で入力しても構わない。

また、Windowsのファイルシステムではファイル名（フォルダ名）に大文字と小文字の区別はない。
そのため、ファイル名も小文字で記述しても構わない。

## ページャを利用する
DOSでは、複数行にいたるコマンドの結果を1画面で見るにはコマンド依存のオプションを利用する必要があった。
しかし、Windowsでは`MORE`コマンドが存在する。

ひとまず、長い行数を持つファイルを生成する。
```cmd
> DIR %WINDIR%\System32 > TEST.TXT
```

`MORE`コマンドは様々な使い方やオプションを持つが、ひとまず`TYPE`と同じように利用する。
```cmd
> MORE TEST.TXT
 Volume in drive C has no label.
 Volume Serial Number is <固有の値>

 Directory of C:\WINDOWS\System32

<省略>
-- More (1%) --
```
画面下の`-- More (1%) --`が、ページャーが起動していることと、現在の位置を表示している。

`Enter`で1行、`Space`で1ページ分次に進む。
`q`で終了する。

## 空のファイルを作る
DOSにおいても方法は存在するが、Windowsの方法のほうが短く、なおかつFreeDOSにて正常に実行できなかったため、ここで取り扱う。

Windowsにおいての空ファイル作成は`NUL`という必ず空になっているファイルをコピーする方法を使う。

ここでは、`EMPTYFILE`という空のファイルを作る。
```cmd
> COPY NUL EMPTYFILE
        1 file(s) copied.
```

試しにファイルサイズを確認するが、0バイトであることがわかると思う。
```cmd
> DIR EMPTYFILE
<省略>
11/02/2021  07:11 PM                 0 EMPTYFILE
<省略>
```

### 中身が存在するフォルダを削除する
`RMDIR`コマンドに`/S`オプションを（多くの場合`/Q`も同時に）指定して実行する。
```cmd
> RMDIR /S /Q DIR1
```

**注意:**`/Q`コマンドは「確認せずに」という意味を持つ。
削除するデータを検証したい場合は指定しないこと。